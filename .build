#!/bin/bash

source .packages.rc

distro=$(lsb_release -c -s)
for package in ${projects[@]}
do
    pushd $package
    echo && pwd

    case "$1" in
	all)
	    make -s -j4 && sudo make -s install
	    if [[ $? != 0 ]]
	    then
		exit -1
	    fi
	    ;;
	single)
	    make -s && sudo make  -s install
	    if [[ $? != 0 ]]
	    then
		exit -1
	    fi
	    ;;
	clean)
	    make -s clean
	    if [[ $? != 0 ]]
	    then
		exit -1
	    fi
	    ;;
	install)
	    sudo make -s install
	    if [[ $? != 0 ]]
	    then
		exit -1
	    fi
	    ;;
	uninstall)
	    sudo make -s uninstall
	    if [[ $? != 0 ]]
	    then
		exit -1
	    fi
	    ;;
	distcheck)
	    rm -rfv *.tar.gz
	    sudo make -s distcheck && sudo make -s install
	    if [[ $? != 0 ]]
	    then
		exit -1
	    fi
	    ;;
	distclean)
	    rm -rfv *.tar.gz
	    sudo make -s distclean
	    if [[ $? != 0 ]]
	    then
		exit -1
	    fi
	    ;;
	config)
	    autoreconf -vfi && ./configure  --prefix=/usr --sysconf=/etc --libdir=/usr/lib --libexecdir=/usr/lib "CXXFLAGS=-O3 -Wall"
	    if [[ $? != 0 ]]
	    then
		exit -1
	    fi
	    ;;
	debug)
	    autoreconf -vfi && ./configure  --prefix=/usr --sysconf=/etc --libdir=/usr/lib --libexecdir=/usr/lib "CXXFLAGS=-O0 -ggdb3 -Wall"
	    if [[ $? != 0 ]]
	    then
		exit -1
	    fi
	    ;;
	package)
	    ./make_deb
	    if [[ $? != 0 ]]
	    then
		exit -1
	    fi
	    ;;
    esac
    popd
done
